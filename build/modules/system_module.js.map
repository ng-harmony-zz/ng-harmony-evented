{"version":3,"sources":["../index.js"],"names":[],"mappings":"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","file":"system_module.js","sourcesContent":["\timport bean from 'fat/bean';\n\timport zest from 'zest';\n\timport 'angular-ui-router';\n\timport { Harmony, Controller } from 'ng-harmony/ng-harmony';\n\timport { Mixin } from 'ng-harmony/ng-harmony-annotate';\n\nexport class RouteController extends Controller {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\t\tinitialize();\n\t}\n\tinitialize () {\n\t\tthis.$scope.$on(\"register\",\n\t\t\t(ev, f, t, s, p, d, listener) => {\n\t\t\t\ts(); //stopPropagation\n\t\t\t\tp(); //preventDefault\n\t\t\t\ttry {\n\t\t\t\t\tthis.LISTENERS = listener;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(\"Couldn't set listener!\");\n\t\t\t\t\tconsole.dir(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.$scope.$on(\"behaviour\",\n\t\t\t(ev, f, t, s, p, d, behaviour) => {\n\t\t\t\ts(); //stopPropagation\n\t\t\t\tp(); //preventDefault\n\t\t\t\tthis.behaviourQueue = behaviour;\n\t\t\t\tthis.behaviour();\n\t\t\t}\n\t\t);\n\t}\n\tget LISTENERS () {\n\t\treturn this._LISTENERS || [];\n\t}\n\tset LISTENERS (o) {\n\t\tlet _o = [].concat(o);\n\t\tfor (let [i, l] of _o.entries()) {\n\t\t\tif (this.constructor.LISTENERS.length) {\n\t\t\t\tthrow new Error(\"No transient definitions found ... not registering listeners\");\n\t\t\t}\n\t\t\tlet match = this.constructor.LISTENERS.filter((m, i, arr) => {\n\t\t\t\tlet el = zest(m.css, document.body);\n\t\t\t\tif (el[0] === l.el) {\n\t\t\t\t\tif (!el.length) {\n\t\t\t\t\t\tthrow new Error(\"Transient definition doesn't match any element!\");\n\t\t\t\t\t} else if (el.length > 1) {\n\t\t\t\t\t\tthrow new Error(\"Transient definitions must be describing unique elements!\");\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t\tthis._LISTENERS.push({\n\t\t\t\tid: l.name.id,\n\t\t\t\tctx: l.ctx,\n\t\t\t\tname: l.name.fn,\n\t\t\t\tcreatedAt: l.name.ts,\n\t\t\t\tel: l.el || null,\n\t\t\t\tcss: match.css,\n\t\t\t\tuid: match.uid\n\t\t\t})\n\t\t}\n\t}\n\tget behaviourQueue () {\n\t\treturn this._behaviourQueue || [];\n\t}\n\tset behaviourQueue (behaviour) {\n\t\tif (this._isEmpty(this._behaviourQueue)) {\n\t\t\tthis._behaviourQueue = [];\n\t\t}\n\t\tthis._behaviourQueue.push(behaviour);\n\t}\n\tget idle () {\n\t\tif (this._isEmpty(this._idle)) {\n\t\t\tthis._idle = true;\n\t\t}\n\t\treturn this._idle;\n\t}\n\tset idle (truthy) {\n\t\tthis._idle = !!truthy;\n\t}\n\tstatic get STATES () {\n\t\treturn this._STATES || [];\n\t}\n\tstatic set STATES (states) {\n\t\tthis._STATES = states;\n\t}\n\tstatic get TOKEN_BEHAVIOUR_SEPARATOR () {\n\t\treturn this._TOKEN_BEHAVIOUR_SEPARATOR || \"->\";\n\t}\n\tstatic set TOKEN_BEHAVIOUR_SEPARATOR (s) {\n\t\tthis._TOKEN_BEHAVIOUR_SEPARATOR = s;\n\t}\n\tstatic get TOKEN_LOGIC_SEPARATOR () {\n\t\treturn this._TOKEN_LOGIC_SEPARATOR || \"::\";\n\t}\n\tstatic set TOKEN_LOGIC_SEPARATOR (s) {\n\t\tthis._TOKEN_LOGIC_SEPARATOR = s;\n\t}\n\tstatic get TOKEN_BEHAVIOUR_SYMBOL () {\n\t\treturn this._TOKEN_BEHAVIOUR_SYMBOL || \"§\";\n\t}\n\tstatic set TOKEN_BEHAVIOUR_SYMBOL (s) {\n\t\tthis._TOKEN_BEHAVIOUR_SYMBOL = s;\n\t}\n\tstatic get TOKEN_CHILD_SYMBOL () {\n\t\treturn this._TOKEN_CHILD_SYMBOL || \"<\";\n\t}\n\tstatic set TOKEN_CHILD_SYMBOL (s) {\n\t\tthis._TOKEN_CHILD_SYMBOL = s;\n\t}\n\t_mapTransientByEl (o) {\n\t\tlet m = this.LISTENERS.filter((el, i, arr) => {\n\t\t\tlet z = zest(el.css, document.body);\n\t\t\tif (z[0] === o.el) {\n\t\t\t\tif (z.length > 1) {\n\t\t\t\t\tthrow new Error(`Your css selection isn't unique ... ${z.length} elements!`);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tif (!m.length) {\n\t\t\tthrow new Error(\"Your transient mapping doesn't match any listener!\");\n\t\t}\n\t\tif (m.length > 1) {\n\t\t\tthrow new Error(`Your transient mapping isn't unique ... ${m.length} elements!`);\n\t\t}\n\t\treturn m[0].uid;\n\t}\n\t_mapTransientByUID (o) {\n\t\treturn this.LISTENERS.filter((el, i, arr) => {\n\t\t\tif (el.uid === o.uid) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t})[0];\n\t}\n\tbehaviour () {\n\t\tif (this.idle === false) {\n\t\t\tconsole.info(\"Behaviour in progress, hold on fast ...\");\n\t\t\treturn;\n\t\t}\n\t\tif (!this.behaviourQueue.length) {\n\t\t\tconsole.info(\"Behaviour Queue empty, idling out ...\");\n\t\t\treturn;\n\t\t}\n\t\tlet b = this.behaviourQueue.unshift();\n\t\tthis.idle = false;\n\t\tthis._behaviour(this._mapTransientByEl(b), b.fromState, b.toState)\n\t\t\t.then(this.behaviour)\n\t\t\t.catch(this.behaviour);\n\t}\n\t_behaviour (uid, fromState, toState) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.__behaviour({\n\t\t\t\tuid: uid,\n\t\t\t\tfromState: fromState,\n\t\t\t\ttoState: toState\n\t\t\t})\n\t\t\t\t.then((...args) => {\n\t\t\t\t\tthis.___behaviour(...args)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.idle = true;\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((el) => {\n\t\t\t\t\t\t\tthis.idle = true;\n\t\t\t\t\t\t\tconsole.dir({\n\t\t\t\t\t\t\t\tcomponent: el.ctx,\n\t\t\t\t\t\t\t\tfromState: el.fromState,\n\t\t\t\t\t\t\t\ttoState: el.toState\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tthrow new Error(\"State Transition malfunction in subcomponent ...\");\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.catch((e) => {\n\t\t\t\t\tthis.idle = true;\n\t\t\t\t\tthrow new Error(\"Result of Child Function call unsuccessfull\");\n\t\t\t\t})\n\t\t});\n\t}\n\t__behaviour (transient) {\n\t\tlet tbs = this.constructor.TOKEN_BEHAVIOUR_SYMBOL,\n\t\t\ttcs = this.constructor.TOKEN_CHILD_SYMBOL,\n\t\t\ttlsep = this.constructor.TOKEN_LOGIC_SEPARATOR,\n\t\t\ttbsep = this.constructor.TOKEN_BEHAVIOUR_SEPARATOR;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._validate(this[`${tbs}${transient.uid}${tlsep}${transient.fromState}${tbsep}${transient.toState}`])\n\t\t\t\t.then((...args) => { resolve(tbs, tcs, tlsep, tbsep, ...args); })\n\t\t\t\t.catch((e) => { reject(e); })\n\t\t});\n\t}\n\t___behaviour (tbs, tcs, tlsep, tbsep, transientMapping) {\n\t\tlet countdown = _transientMapping.length;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tfor (let [i, el] of _transientMapping.entries()) {\n\t\t\t\t((_el) => {\n\t\t\t\t\tthis._validate(_el.ctx[`${tbs}${tcs}${_el.fromState}${tbsep}${_el.toState}`].bind(_el.ctx))\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (--countdown < 1) {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\treject(_el);\n\t\t\t\t\t\t});\n\t\t\t\t})(this._mapTransientByUID(el));\n\t\t\t}\n\t\t});\n\t}\n\n\n}\n\n\texport class EventedController extends Controller {\n\t\tconstructor(...args) {\n\t\t\tsuper(...args);\n\n\t\t\tfor (let [key, fn] of this.iterate(this.constructor.prototype)) {\n\t\t\t\tif (!this._isEventedFunction(key, fn)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet tokens = this._getTokens(key.slice(1));\n\t\t\t\tif (tokens === false) { continue; }\n\n\t\t\t\tfor (let [i, el] of (tokens[0] ?\n\t\t\t\t\t\tzest(tokens[0], this.$element.context).entries() :\n\t\t\t\t\t\t[this.$element.context].entries())) {\n\t\t\t\t\tthis.closurize((_key, _fn, _el, _i) => {\n\t\t\t\t\t\tlet __fn = (...args) => {\n\t\t\t\t\t\t\tthis._preEventedFunction(args[0], _el, _i, tokens);\n\t\t\t\t\t\t\t_fn(_el, _i, ...args);\n\t\t\t\t\t\t\tthis._postEventedFunction(_key, _fn, _el, _i, tokens);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbean.on(el, tokens[1], tokens[2] || _fn, tokens[2] ? _fn : null);\n\t\t\t\t\t}, this, key, fn, el, i);\n\t\t\t\t\tthis.digest();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstatic get TOKEN_EVENT_SEPARATOR () {\n\t\t\treturn this._TOKEN_EVENT_SEPARATOR || \"::\";\n\t\t}\n\t\tstatic set TOKEN_EVENT_SEPARATOR (s) {\n\t\t\tthis._TOKEN_EVENT_SEPARATOR = s;\n\t\t}\n\t\tstatic get TOKEN_EVENT_SYMBOL () {\n\t\t\treturn this._TOKEN_EVENT_SYMBOL || \"$\";\n\t\t}\n\t\tstatic set TOKEN_EVENT_SYMBOL (s) {\n\t\t\tthis._TOKEN_EVENT_SYMBOL = s;\n\t\t}\n\t\t_getTokens (fnName) {\n\t\t\tlet t = fnName.split(this.constructor.TOKEN_EVENT_SEPARATOR);\n\t\t\treturn this._validateTokens(t) ? t : false;\n\t\t}\n\t\t_validateTokens (t) {\n\t\t\treturn this._validate(() => {\n\t\t\t\tif (t.length < 2) {\n\t\t\t\t\tthrow new Error(`Syntax error: ${key}::${this._name}`);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}).then((truth) => {\n\t\t\t\tif (truth) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}).catch((e) => {\n\t\t\t\tconsole.log(\"Cannot validate tokens ... bailing out\");\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\t_parseEventedFunction (tokens) {\n\t\t\tif (!this._isEmpty(tokens[2]) && !!~tokens[2].indexOf(\"<\")) {\n\t\t\t\ttokens.splice(2, 1, ...tokens[2].split(\"<\"));\n\t\t\t}\n\t\t\treturn tokens;\n\t\t}\n\t\t_preEventedFunction (tokens, ev, ...args) {\n\t\t\ttokens = this._parseEventedFunction(tokens);\n\t\t\tif (typeof tokens[2] !== \"undefined\" && tokens[2] !== null) {\n\t\t\t\tif (typeof tokens[3] !== \"undefined\" && tokens[3] !== null) {\n\t\t\t\t\tlet el = ev.currentTarget.parentNode;\n\t\t\t\t\twhile (!zest.matches(el, tokens[3])) { el = el.parentNode; }\n\t\t\t\t\tlet list = Array.prototype.slice.call(el.parentNode.children);\n\t\t\t\t\tthis.$scope.n = list.indexOf(el);\n\t\t\t\t} else {\n\t\t\t\t\tlet el = ev.currentTarget;\n\t\t\t\t\tlet list = Array.prototype.slice.call(el.parentNode.children);\n\t\t\t\t\tthis.$scope.n = list.indexOf(el);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_postEventedFunction (key, fn, el, i, tokens) {\n\t\t\tthis._logEventedFunction(...[key, fn, el, i]);\n\t\t\tthis._emit(key, tokens)\n\t\t}\n\t\t_isEventedFunction (key, val) {\n\t\t\treturn (typeof val === \"function\" &&\n\t\t\t\t!~[this.constructor.TOKEN_EVENT_SYMBOL].indexOf(key[0]));\n\t\t}\n\t\t_emit (triggerFn, tokens) {\n\t\t\tthis.$scope.$emit(\"change\", {\n\t\t\t\tscope: this,\n\t\t\t\ttriggerFn: triggerFn,\n\t\t\t\ttriggerTokens: tokens\n\t\t\t});\n\t\t}\n\t}\n\tEventedController.$inject = [\"$element\", \"$timeout\"];\n\n@Mixin([RouteController])\nexport class StatefulController extends EventedController {\n\tconstructor (...args) {\n\t\tsuper(...args);\n\n\t\tthis.initialize();\n\n\t\tthis.$scope.$emit(\"register\", {\n\t\t\tname: this._name,\n\t\t\tctx: this,\n\t\t\tel: this.$element.context\n\t\t});\n\n\t\tfor (let [key, fn] of this.iterate(this.constructor.prototype)) {\n\t\t\tif (!this._isEventedFunction(key, fn)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet keys = key.split(\",\");\n\n\t\t\tlet hook = (phrase) => {\n\t\t\t\tlet type = key.charAt(0),\n\t\t\t\t\tancestryType = key.charAt(1),\n\t\t\t\t\ttokens = null;\n\t\t\t\tthis._validate(this._getTokens(key))\n\t\t\t\t\t.then((t) => {\n\t\t\t\t\t\ttokens = t;\n\t\t\t\t\t\tif (type === this.constructor.TOKEN_EVENT_SYMBOL) {\n\t\t\t\t\t\t\tfor (let [i, el] of (tokens[0] ?\n\t\t\t\t\t\t\t\t\tzest(tokens[0], this.$element.context).entries() :\n\t\t\t\t\t\t\t\t\t[this.$element.context].entries())) {\n\t\t\t\t\t\t\t\tthis.closurize((_key, _fn, _el, _i) => {\n\t\t\t\t\t\t\t\t\tlet __fn = (...args) => {\n\t\t\t\t\t\t\t\t\t\tthis._preEventedFunction(args[0], _el, _i, tokens);\n\t\t\t\t\t\t\t\t\t\tlet transientMap = _fn(_el, _i, ...args);\n\t\t\t\t\t\t\t\t\t\tthis._postEventedFunction(_key, _fn, _el, _i, mapping, transientMap);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbean.on(el, tokens[1], tokens[2] || _fn, tokens[2] ? _fn : null);\n\t\t\t\t\t\t\t\t}, this, key, fn, el, i);\n\t\t\t\t\t\t\t\tthis.digest();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (type === this.constructor.TOKEN_BEHAVIOUR_SYMBOL) {\n\t\t\t\t\t\t\tif (ancestryType === this.constructor.TOKEN_PARENT_SYMBOL) {\n\t\t\t\t\t\t\t\tthis[key] = ((that, _key, _fn, _el, _i) => {\n\t\t\t\t\t\t\t\t\treturn this.closurize((__key, __fn, __el, __i) => {\n\t\t\t\t\t\t\t\t\t\tlet transientMap = __fn(__el, __i);\n\t\t\t\t\t\t\t\t\t\treturn this._postEventedFunction(__key, __fn, __el, __i, null, transientMap);\n\t\t\t\t\t\t\t\t\t}, that, _key, _fn, _el, _i);\n\t\t\t\t\t\t\t\t}).bind(this, key, fn, el, i)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis[key] = fn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t})\n\t\t\t\t\t.catch((e) => {\n\t\t\t\t\t\tthrow new Error(`Couldn't validate/parse tokens of given behaviour symbols ${key}`);\n\t\t\t\t\t})\n\t\t\t}\n\t\t\tif (keys.length > 1) {\n\t\t\t\tlet tbs = this.constructor.TOKEN_BEHAVIOUR_SYMBOL,\n\t\t\t\t\ttlsep = this.constructor.TOKEN_LOGIC_SEPARATOR,\n\t\t\t\t\ttss = this.constructor.TOKEN_SELF_SYMBOL,\n\t\t\t\t\tindex = -1,\n\t\t\t\t\tmapping = null;\n\t\t\t\tif (!!keys.filter((el, i, arr) => {\n\t\t\t\t\tif (el.indexOf(`${tbs}${tbsep}`) === 0) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tmapping = el.slice(tbs.length + tss.length);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t};\n\t\t\t\t\treturn false;\n\t\t\t\t}).length) {\n\t\t\t\t\tkeys.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tfor (let [i, curKey] of keys.entries()) {\n\t\t\t\t\tthis._validate(hook.bind(this, curKey));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._validate(hook.bind(this, keys[0]))\n\t\t\t}\n\t\t}\n\t}\n\tstatic get TOKEN_PARENT_SYMBOL () {\n\t\treturn this._TOKEN_PARENT_SYMBOL || \">\";\n\t}\n\tstatic set TOKEN_PARENT_SYMBOL (s) {\n\t\tthis._TOKEN_PARENT_SYMBOL = s;\n\t}\n\tstatic get TOKEN_SELF_SYMBOL () {\n\t\treturn this._TOKEN_SELF_SYMBOL || \"!\";\n\t}\n\tstatic set TOKEN_SELF_SYMBOL (s) {\n\t\tthis._TOKEN_SELF_SYMBOL = s;\n\t}\n\t_isEventedFunction (key, val) {\n\t\tif (!this._isFunction(val)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (key.charAt(0) === this.constructor.TOKEN_EVENT_SYMBOL ||\n\t\t\tkey.charAt(0) === this.constructor.TOKEN_BEHAVIOUR_SYMBOL) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t_getTokens (fn) {\n\t\tlet _fn = null;\n\t\tif (fn.charAt(0) === this.constructor.TOKEN_EVENT_SYMBOL) {\n\t\t\t_fn = fn.slice(1);\n\t\t\tlet t = _fn.split(this.constructor.TOKEN_EVENT_SEPARATOR);\n\t\t\treturn this._validateTokens(t) ? t : false;\n\t\t} else if (fn.charAt(0) === this.constructor.TOKEN_BEHAVIOUR_SYMBOL) {\n\t\t\tif (fn.charAt(1) === this.constructor.TOKEN_CHILD_SYMBOL ||\n\t\t\t\tfn.charAt(1) === this.constructor.TOKEN_PARENT_SYMBOL) {\n\t\t\t\t_fn = fn.slice(2);\n\t\t\t\tlet __fn = _fn.split(this.constructor.TOKEN_LOGIC_SEPARATOR);\n\t\t\t\t__fn.concat(__fn[1].split(this.constructor.TOKEN_BEHAVIOUR_SEPARATOR));\n\t\t\t\treturn this._validateTokens(__fn) ? __fn : false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error(`Child Behaviour needs to be prefixed by ${this.constructor.TOKEN_CHILD_SYMBOL}`);\n\t\t\t}\n\t\t}\n\t}\n\t_postEventedFunction (key, fn, el, i, tokens, transientMap) {\n\t\tlet _tokens = tokens.split(this.constructor.TOKEN_BEHAVIOUR_SEPARATOR),\n\t\t\ttbs = this.constructor.TOKEN_BEHAVIOUR_SYMBOL,\n\t\t\ttps = this.constructor.TOKEN_PARENT_SYMBOL,\n\t\t\ttbsep = this.constructor.TOKEN_BEHAVIOUR_SEPARATOR;\n\t\tthis._logEventedFunction(...[key, fn, el, i, transientMap]);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.___behaviour(tbs, tps, null, tbsep, transientMap)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (!this._isEmpty(tokens)) {\n\t\t\t\t\t\tthis._emit(key, {\n\t\t\t\t\t\t\tfrom: _tokens[0],\n\t\t\t\t\t\t\tto: _tokens[1]\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((e) => {\n\t\t\t\t\tconsole.warn(\"Call to child behaviour resulted in unsuccessfull state.\");\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t});\n\t}\n\t_emit (triggerFn, tokens) {\n\t\tthis.$scope.$emit(\"behaviour\", {\n\t\t\tel: this.$element.context,\n\t\t\tfromState: tokens.from,\n\t\t\ttoState: tokens.to\n\t\t});\n\t}\n}"]}